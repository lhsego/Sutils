% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cheb.2step.od.R
\name{cheb.2step.od}
\alias{cheb.2step.od}
\title{2-step Chebyshev outlier detection}
\usage{
cheb.2step.od(the.vector, unimodal = TRUE, first.rejval = 1/1000,
  second.rejvals = c(1/100, 1/1000, 1/10000), do.plot = FALSE,
  zero.var.correction = TRUE, one.sided = NULL, ...)
}
\arguments{
\item{the.vector}{Vector of numeric data}

\item{unimodal}{\code{=TRUE} assumes the data come from a unimodal
distribution}

\item{first.rejval}{A numerical probability cutoff value used to identify
the initial Chebyshev limits that will filter the data for the calculation
of the second step Chebyshev limits}

\item{second.rejvals}{A vector of probability cutoff values that are used in
the second application of the Chebychev filter}

\item{do.plot}{\code{=TRUE} produces a histogram that shows the data, the
first step Chebyshev limit in gray and the second Chebyshev limits in blue.}

\item{zero.var.correction}{\code{=TRUE} ensures that the filtered data set
(used for the second step) does not have zero variance.  See Details.}

\item{one.sided}{if "upper" (or "lower"), it calculates a one-sided upper
(or lower) Chebyshev limit (in both steps) instead of the usual two-sided
limit.  Defaults to \code{NULL}, which produces the two-sided limit.}

\item{\dots}{Additional arguments to \code{my.histogram}}
}
\value{
A list with the following components \item{output}{A matrix with the
requested second step probabilities and the second step Chebyshev limits}
\item{removed.in.step1}{Shows the data points that were filtered and not
used in calculating the Chebyshev limits in step 2} \item{step1.cv}{A matrix
with the requested first step probabilities and the first step Chebyshev
limits}
}
\description{
Uses a 2-step (unimodal and/or one-sided) Chebyshev outlier detection to
identify outliers or unusual values.
}
\details{
In the first step, the Chebyshev limit is used to filter gross outliers from
the data.  The filtered data are then used to estimate the mean and standard
deviation that are used to contruct the Chebyshev limits during the second
step.  This way, the estimates of the mean and standard deviation are not
unduly influenced by large outliers.

When \code{zero.variance.correction=TRUE}, outliers identified on the first
pass are set equal to the first Chebyshev limit (instead of being removed)
if removing those outliers creates a filtered data vector that has 0
variance.  This ensures that the filtered data set (used for the second
step) does not have zero variance.
}
\examples{

# Unimodal, 2-sided example from the Cauchy distribution
cheb.2step.od(rt(500, df=1), first.rejval=0.01, second.rejvals=10^(-2:-5))

# Unimodal, 1-sided upper example using a mixture of Gamma variates
cheb.2step.od(c(rgamma(200, shape=10, scale=20), rgamma(5, shape=10, scale=500)),
              first.rejval=0.01, one.sided="upper")

# Unimodal, 1-sided lower example using a mixture of Gamma variates
cheb.2step.od(-1 * c(rgamma(200, shape=10, scale=20), rgamma(5, shape=10, scale=500)),
              first.rejval=0.01, one.sided="lower")


}
\author{
Brett Amidan with additions from John Hathway and Landon Sego
}
\seealso{
\code{\link{cheb.od}}
}
\keyword{misc}

